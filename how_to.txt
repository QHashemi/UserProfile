Setup database using Entity Framework Core:
1. Create folder name Entities and add User.cs entity
2. Create folder name Data and add DbContext.cs
3. Create Db in sql server management studio
4. Connect db with visual studio and copy the connection string
5. Add connection string in appsettings.json
6. Add DbContext in Program.cs
7. Run the migration commands in Package Manager Console
   - Add-Migration InitialCreate
   - Update-Database


Create AuthController:
1. Create folder name Controllers and add AuthController.cs
2. Add Register and Login methods in AuthController.cs
3. Create folder name DTOs and add UserRegisterDto.cs and UserLoginDto.cs
4. Create folder name Services and add AuthService.cs
5. Create folder name Interfaces and add IAuthService.cs
6. User AuthServices in AuthController.cs


Setup Helth Checks:
1. Create new Controller name HealthController.cs
2. Add /health
3. add /api
4. add /db
6. add /
7. add /ready
8. add /live


Setup Scalar:
1. Install package name scalar.AspNetCore
2. Add Scalar in Program.cs
if (app.Environment.IsDevelopment())
	{
		app.MapScalarApiReference();
	}


Implement JWT to secure Enpoint:
1. Install package name System.IdentityModel.Tokens.Jwt
2. Add JWT settings in appsettings.json
3. Create GenerateTokenFunction in AuthService.cs
4. Add AccessToken propertie inside LoginResponseDto
   public string AccessToken { get; set; }
5. Send Response with user information and token.


Secure Endpoint with JWT Middleware
1. Install package name Microsoft.AspNetCore.Authentication.JwtBearer
2. Add builder.Services.AddAuthentication configuration in Program.cs
3. Set [Authrize] options for every end point you wanna secure


Secure Endpoint with JWT and Role
1. Update User Entity to include Role property
   public string Role { get; set; }
2. Run Follwing command to update Database Table
    add-migration AddUserRole
	update-database
3. Create new endpoint inside UserController for assigning roles
4. Update Claims in GenerateAccessToken method to include Role claim
    claims.Add(new Claim(ClaimTypes.Role, user.Role));
5. Update the controller methods to use role-based authorization
6. Update Response and Request Dto
7. The Role in [Authorize(roles="admin")] must match the Role assigned to the user during registration or through role assignment.


Implement Refresh Token
1. Update Entitiy with Refresh Token and Refresh Token Expire Time, so that we can save the refresh token inside database
2. Run following command to update entity: 
	Add-Migration AddRefreshToken
	Update-Database
3. Create three function to process refresh token as following:
	GenerateRefreshToken => Generate 64Bit Refresh Token
	GenerateAndSaveRefreshTokenAsync => Generate 64Bit and Save the refresh token in DB
	ValidateRefreshTokenAsync => Validate Refresh Token with UserId and return new AcceseToken and RefreshToken
4. Create Service Name RefreshTokenAsync to combine all the function and Return as service to RefreshToken Controller
5. Create EndPoint inside controller name RefreshToken  and Send back the new AccessToken and RefreshToken to the Client.


Handling Errors Middlewares:
1. Create error handling middleware like ExceptionHandlingMiddleware.cs
2. Add Middleware inside Program.cs and it should be before UseAuthorization and MapControllers
3. Add Middleware as following: app.UseMiddleware<ExceptionHandlingMiddleware>();
4. Remove every try and catch block because the middlware handle everything by it self.
	try { ... } catch { ... }
5. Use Middleware as following:
	throw new InvalidOperationException("Boom");
	throw new Exception("Something went wrong");
	...

Add Logger middleware to log messages:
1. Install package name Serilog as following:

	dotnet add package Serilog.AspNetCore
	dotnet add package Serilog.Sinks.File
	dotnet add package Serilog.Sinks.Console

2. Add Logger configuration in Program.cs
	Log.Logger = new LoggerConfiguration()
		.MinimumLevel.Debug()
		.WriteTo.Console()
		.WriteTo.File("Logs/log.txt", rollingInterval: RollingInterval.Day)
		.CreateLogger();



Add CustomLogger:
1. Create CustomLogger class
2. Create Interface CustomLogger
3. Register CustomLogger inside program.cs

Add LoggerMiddleware:
1. Create RequestLoggingMiddleware.cs file inside Middleware folder
2. Add Logic 
3. Use CustomLogger to log information into a files

	







 





